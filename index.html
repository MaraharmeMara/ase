<!-- <!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Ase</title>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- we import arjs version without NFT but with marker + location based support 
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <script src="./assets/gesture-detector.js"></script>
    <script src="./assets/gesture-handler.js"></script>

    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-9ndCyUaIbzAi2FUVXJi0CjmCapSmO7SnpJef0486qhLnuZ2cdeRhO02iuK6FUUVM"
      crossorigin="anonymous"
    />
  </head>
  <body style="margin: 0px; overflow: hidden">
    <div class="container fixed-top">
      <div class="col-6">
        <button class="btn">
          ?
          <span class="spinner-border spinner-border-sm loadingCheck"></span>
        </button>

        <img
          class="row hint-img d-none"
          src="./viinitorni_ohje(suurempi).gif"
          alt=""
        />
      </div>
    </div>

    <a-scene
      id="scene"
      embedded
      arjs="sourceType: webcam; debugUIEnabled: false;"
      renderer="logarithmicDepthBuffer: true;"
      vr-mode-ui="enabled: false"
      gesture-detector
      look-controls
    >
      <a-marker-camera
        marker="hiro"
        smooth="true"
        smooth-tolerance="1"
        smooth-threshol="10"
        raycaster="objects: .clickable"
        emitevents="true"
        cursor="fuse: false; rayOrigin: mouse;"
        id="markerA"
      >
        <a-entity
          class="clickable"
          rotation="0 90 0"
          position="0 0 0"
          scale="0.1 0.1 0.1"
          gltf-model="./gun.glb"
          gesture-handler
          follow="#markerA"
          visible="true"
        ></a-entity>
      </a-marker>
      <!-- <a-entity camera></a-entity> 
            <!-- Ambient Light 
      <a-light
        type="ambient"
        color="#ffffff"
        intensity="0.8"
      ></a-light>

      <!-- Directional Light 
      <a-light
        type="directional"
        color="#ffffff"
        intensity="0.8"
        position="2 4 -3"
      ></a-light>
      </a-scene>

    <script>
      const hintBtn = document.querySelector(".hint-btn");
      hintBtn.addEventListener("click", () => {
        const hintImg = document.querySelector(".hint-img");
        hintImg.classList.toggle("d-none");
      });

      const loads = document.querySelector(".clickable");
      loads.addEventListener("model-loaded", () => {
        const loadingCheck = document.querySelector(".loadingCheck");
        loadingCheck.classList.toggle("d-none");
      });

      //
      //     /* model on a place for some time */
      //   window.addEventListener('load', function() {
      //   var modelEntity = document.querySelector('.clickable');

      //   // Delay in milliseconds before the model disappears (e.g., 5000ms = 5 seconds)
      //   var delayBeforeDisappear = 5000;

      //  function showModel() {
      //    modelEntity.setAttribute('visible', 'true');
      //   setTimeout(hideModel, delayBeforeDisappear);
      //   }

      //  function hideModel() {
      //   modelEntity.setAttribute('visible', 'false');
      //   }

      //   // Listen for the marker-found event to show the model when the marker is detected
      //   document.querySelector('a-marker').addEventListener('markerFound', showModel);
      //   });
      window.addEventListener('load', function() {
  var modelEntity = document.querySelector('.clickable');
  var marker = document.querySelector('#markerA');
  
  var deviceOrientation = null;
  var modelQuaternion = new THREE.Quaternion();

  function updateModelPosition() {
    if (deviceOrientation) {
      var quaternion = new THREE.Quaternion(
        deviceOrientation.x,
        deviceOrientation.y,
        deviceOrientation.z,
        deviceOrientation.w
      );
      modelQuaternion.multiplyQuaternions(quaternion, modelQuaternion);
      modelEntity.setAttribute('rotation', modelQuaternion.toEuler().toVector3());
    }
    requestAnimationFrame(updateModelPosition);
  }

  function onDeviceOrientationChange(event) {
    deviceOrientation = event.detail;
  }

  // Listen for the marker-found event to show the model when the marker is detected
  document.querySelector('a-marker').addEventListener('markerFound', function() {
    modelEntity.setAttribute('visible', 'true');
    window.addEventListener('deviceorientation', onDeviceOrientationChange);
    updateModelPosition();
  });

  // Listen for the marker-lost event to hide the model when the marker is not detected
  document.querySelector('a-marker').addEventListener('markerLost', function() {
    modelEntity.setAttribute('visible', 'false');
    window.removeEventListener('deviceorientation', onDeviceOrientationChange);
  });
});
</script>
 <script>
  AFRAME.registerComponent('arjs-tracking',  {
    init: function () {
      const sceneEl = this.el;
      const markerEl = sceneEl.querySelector('#markerA');

      ARController.getUserMediaThreeScene({
        maxARVideoSize: 640,
        facing: 'environment',
      }).then(function (arScene) {
        arScene.init(function onReady() {
          sceneEl.object3D.add(arScene.canvas);
        });
        arScene.setPatternDetectionMode(artoolkit.AR_MATRIX_CODE_DETECTION);
        arScene.setMatrixCodeType(artoolkit.AR_MATRIX_CODE_3x3);
        arScene.setPattRatio(0.8);
        arScene.setMatrixCodeType(artoolkit.AR_MATRIX_CODE_3x3);
        arScene.start();
      });
    }
  });
 </script>
  </body>
</html> -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR-gun</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/artoolkitx/jsartoolkit5/master/build/artoolkit.min.js"></script>

</head>
<body>
  
    <a-scene
  id="scene"
  embedded
  arjs="sourceType: webcam; debugUIEnabled: false;"
  vr-mode-ui="enabled: false"
  gesture-detector
  hit-testing-enabled
>
  <!-- 3D Model -->
  <a-entity
    class="clickable"
    gltf-model="./gun.glb"
    gesture-handler
    scale="0.5 0.5 0.5" 
    position="0 -4 1"> <!-- Initial position of the model (will be updated by hit-testing) -->
  </a-entity>

  <!-- Camera and Light -->
  <a-camera></a-camera>
  <a-light
    type="ambient"
    color="#ffffff"
    intensity="0.8"
  ></a-light>
</a-scene>

</body>
</html>